<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PS1-Vibe Racing Game</title>
    <!-- CODEX: Include pixelated font -->
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Three.js for 3D rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Tone.js for sound effects (jsDelivr) -->
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.77/build/Tone.min.js"></script>
    <!-- noise.js for procedural textures -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/noisejs/2.0.0/perlin.min.js"></script>
    <!-- CODEX DEBUG: log environment and catch errors -->
    <script>
      window.addEventListener('error', e => {
        console.error('Error:', e.message, e.filename, e.lineno, e.colno);
        const errDiv = document.createElement('div');
        Object.assign(errDiv.style, { position:'absolute', top:'0', left:'0', background:'red', color:'white', padding:'4px', zIndex:'9999' });
        errDiv.innerText = 'Error: ' + e.message;
        document.body.appendChild(errDiv);
      });
      document.addEventListener('DOMContentLoaded', () => {
        const dbgDiv = document.createElement('div');
        Object.assign(dbgDiv.style, { position:'absolute', top:'0', left:'0', background:'yellow', color:'black', padding:'4px', zIndex:'9998' });
        const globals = ['THREE','assets','initRender','input','audio','gameLogic','ui','drivers','tracks'];
        const loaded = globals.filter(k => typeof window[k] !== 'undefined');
        dbgDiv.innerText = 'Loaded globals: ' + loaded.join(', ');
        document.body.appendChild(dbgDiv);
      });
    </script>
    <!-- MIDI.js for MIDI playback -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/midijs/0.3.0/MIDI.min.js"></script>
    <!-- CODEX: favicon to avoid 404 -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">  
</head>
<body>
    <!-- CODEX: Game canvas container -->
    <canvas id="game-canvas"></canvas>
    <!-- Load game modules -->
    <script src="assets.js"></script>
    <script src="render.js"></script>
    <script src="input.js"></script>
    <script src="audio.js"></script>
    <script src="gameLogic.js"></script>
    <script src="ui.js"></script>
    <script src="drivers.js"></script>
    <script src="tracks.js"></script>
    <script src="game.js"></script>
</body>
</html>
